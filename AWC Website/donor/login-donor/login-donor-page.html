<!DOCTYPE html>
<html lang="en">
<head>
  <link rel="shortcut icon" href="#">
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Login Donor</title>
  <link href="https://fonts.googleapis.com/css?family=Karla:400,700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.materialdesignicons.com/4.8.95/css/materialdesignicons.min.css">
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css">
  <link rel="stylesheet" href="assets/css/login.css">
</head>
<body>
  <main class="d-flex align-items-center min-vh-100 py-3 py-md-0">
    <div class="container">
      <div class="card login-card">
        <div class="row no-gutters">
          <div class="col-md-5">
            <img src="assets/images/login-pic.jpg" alt="login" class="login-card-img">
          </div>
          <div class="col-md-7">
            <div class="card-body">
              <div class="brand-wrapper">
                <img src="assets/images/ahsana-logo.jpg" alt="logo" class="logo">
              </div>
              <p class="login-card-description">Sign into your account, our Donor!</p>
              <form action="#!">
                  <div class="form-group">
                    <label for="email" class="sr-only">Email</label>
                    <input type="email" name="email" id="emaillogin" class="form-control" placeholder="Email address">
                  </div>
                  <div class="form-group mb-4">
                    <label for="password" class="sr-only">Password</label>
                    <input type="password" name="password" id="passwordlogin" class="form-control" placeholder="***********">
                  </div>
                  <input name="login" id="login" class="btn btn-block login-btn mb-4" type="button" value="Login">
                </form>
                <a href="#!" class="forgot-password-link" id="reset">Forgot password?</a><br>
                <p>Don't have an account? <a href="../register-donor/register-donor-page.html" class="text-reset">Register here</a></p>
                <p>Are you Ahsana staff? <a href="../../admin/login-admin/login-admin-page.html" class="text-reset">Login here</a></p>
                <nav class="login-card-footer-nav">
                 
                </nav>
            </div>
          </div>
        </div>
      </div>
     
    </div>
  </main>
  <!-- <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script> -->
  <!-- <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"></script> -->
  <!-- <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"></script> -->
</body>

<script src="resetpassword.js"></script>
<script type="module">
  // Import the functions you need from the SDKs you need
  import { initializeApp } from "https://www.gstatic.com/firebasejs/9.21.0/firebase-app.js";
  import { getDatabase, ref, onValue } from "https://www.gstatic.com/firebasejs/9.21.0/firebase-database.js";
  // import { getDatabase } from "https://www.gstatic.com/firebasejs/9.21.0/firebase-database.js";
  import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, sendPasswordResetEmail, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/9.21.0/firebase-auth.js";

  // TODO: Add SDKs for Firebase products that you want to use
  // https://firebase.google.com/docs/web/setup#available-libraries

  // Your web app's Firebase configuration
  const firebaseConfig = {
    apiKey: "AIzaSyAnRXDaONlj8ebUzJh-8veX1GtgI9IF3Hs",
    authDomain: "ahsana-welfare-center-52143.firebaseapp.com",
    databaseURL: "https://ahsana-welfare-center-52143-default-rtdb.firebaseio.com",
    projectId: "ahsana-welfare-center-52143",
    storageBucket: "ahsana-welfare-center-52143.appspot.com",
    messagingSenderId: "52579977535",
    appId: "1:52579977535:web:d259c9b4952431c5daab8a"
  };

  // Initialize Firebase
  const app = initializeApp(firebaseConfig);
  // const database = getDatabase(app);
  const auth = getAuth(app);


  document.getElementById("login").addEventListener('click',  function(){

const email1 = document.getElementById("emaillogin").value
const password1 = document.getElementById("passwordlogin").value

signInWithEmailAndPassword(auth, email1, password1)
  .then((userCredential) => {
    // Signed in 
    const user = userCredential.user;
    const uid = user.uid;

    alert('Successfully login! Donor');
    window.location.href = '../homepage-donor/homepage-donor.html';
    // ...
  })
  .catch((error) => {
    const errorCode = error.code;
    const errorMessage = error.message;

    // console.log(errorCode + errorMessage)
    alert('Invalid Credential');
    window.location.reload();
  });

  } )

  // login donor tested and done 

  // //Reset Password
  // let Reset = document.querySelector("#reset")

  // reset.addEventListener("click",function(){
  //   let email = document.querySelector("#resetEmail")
  //   const auth = getAuth();
  //   sendPasswordResetEmail(auth,email.value)
  // .then(() => {
  //   //Password reset email sent!
  //   //
  //   console.log("Reset Password Link Sent Through Email")
  // })
  // .catch((error) => {
  //   const errorCode = error.code;
  //   const errorMessage = error.message;
  // });
  // });
  
  // let Reset = document.querySelector("reset")
  // reset.addEventListener("click", 
  // function resetPassword(email) {
  //   sendPasswordResetEmail(auth, email)
  //   .then(() => {
  //     console.log('Password reset email sent successfully');
  //   })
  //   .catch((error) => {
  //     console.error('Error sending password reset email:', error);
  //   });
  // })
  
  // //listen for authentication state changes
  // onAuthStateChanges(auth, (user) => {
  //   if (user) {
  //     const userEmail = user.email;
  //     console.log('User email:', userEmail);
  //   }
  // });

//   firebase.initializeApp(firebaseConfig);

// // Function to reset the user's password
// async function resetPassword(email) {
//   try {
//     // Check if the user exists in the database
//     const snapshot = await firebase.database().ref('https://console.firebase.google.com/u/0/project/ahsana-welfare-center-52143/authentication/users').orderByChild('identifier').equalTo(email).once('value');
//     const userData = snapshot.val();

//     if (!userData) {
//       console.log('User with provided email does not exist.');
//       return;
//     }

//     // Get the user's Firebase UID
//     const userId = Object.keys(userData)[0];

//     // Send password reset email
//     await firebase.auth().sendPasswordResetEmail(email);

//     console.log('Password reset email sent successfully!');
//   } catch (error) {
//     console.error('Error resetting password:', error);
//   }
// }

// // Usage example
// const userEmail = 'saidahsaiful2201@gmail.com';
// resetPassword(userEmail);

</script>
</html>
